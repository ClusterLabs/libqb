<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>libqb: Atomic operations</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="index.html">index</a>
  </div>
</div>
<div class="contents">


<h1><a class="anchor" id="qb_atomic_overview">Atomic operations </a></h1><p>Basic atomic integer and pointer operations. The following functions can be used to atomically access integers and pointers. They are implemented as inline assembler function on most platforms and use slower fall-backs otherwise. Using them can sometimes save you from using a performance-expensive pthread_mutex to protect the integer or pointer.The most important usage is reference counting. Using <a class="el" href="qbatomic_8h.html#aa6d16c0f72f2b24d06eff6f740c08e73" title="Atomically increments the integer pointed to by atomic by 1.">qb_atomic_int_inc()</a> and <a class="el" href="qbatomic_8h.html#ac2cf6faea05c0632d7bd7c0e06d5193c" title="Atomically decrements the integer pointed to by atomic by 1.">qb_atomic_int_dec_and_test()</a> makes reference counting a very fast operation.You must not directly read integers or pointers concurrently accessed by multiple threads, but use the atomic accessor functions instead. That is, always use <a class="el" href="qbatomic_8h.html#a9035e2ff68d182ca66bb7c2e389a70e0">qb_atomic_int_get()</a> and <a class="el" href="qbatomic_8h.html#adbe4f6d283dcb1ab027c751b6f4f4553">qb_atomic_pointer_get()</a> for read outs. They provide the necessary synchonization mechanisms like memory barriers to access memory locations concurrently.If you are using those functions for anything apart from simple reference counting, you should really be aware of the implications of doing that. There are literally thousands of ways to shoot yourself in the foot. So if in doubt, use a pthread_mutex. If you don't know, what memory barriers are, do not use anything but <a class="el" href="qbatomic_8h.html#aa6d16c0f72f2b24d06eff6f740c08e73" title="Atomically increments the integer pointed to by atomic by 1.">qb_atomic_int_inc()</a> and <a class="el" href="qbatomic_8h.html#ac2cf6faea05c0632d7bd7c0e06d5193c" title="Atomically decrements the integer pointed to by atomic by 1.">qb_atomic_int_dec_and_test()</a>.It is not safe to set an integer or pointer just by assigning to it, when it is concurrently accessed by other threads with the following functions. Use <a class="el" href="qbatomic_8h.html#a91f1e74d0097ef45fd447bf7fd4ef3bc" title="Compares oldval with the integer pointed to by atomic and if they are equal, atomically...">qb_atomic_int_compare_and_exchange()</a> or <a class="el" href="qbatomic_8h.html#aa7fa4d5c2a48a9f998651bc639d8003a" title="Compares oldval with the pointer pointed to by atomic and if they are equal, atomically...">qb_atomic_pointer_compare_and_exchange()</a> respectively.  </p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="qbatomic_8h.html" title="Basic atomic integer and pointer operations.">qbatomic.h</a> </dd></dl>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on 2 Feb 2016 for libqb by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
