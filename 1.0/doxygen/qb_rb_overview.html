<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>libqb: Ringbuffer</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="index.html">index</a>
  </div>
</div>
<div class="contents">


<h1><a class="anchor" id="qb_rb_overview">Ringbuffer </a></h1><p>This implements a ring buffer that works in "chunks" not bytes. So you write/read a complete chunk or not at all. There are two types of ring buffer normal and overwrite. Overwrite will reclaim the oldest chunks inorder to make way for new ones, the normal version will refuse to write a new chunk if the ring buffer is full.This implementation is capable of working across processes, but one process must only write and the other prrocess read.The read process will do the following: </p>
<div class="fragment"><pre class="fragment">        rb = <a class="code" href="qbrb_8h.html#ad7f0ee52204d491ddb6c5adf88e38c31" title="Create the ring buffer with the given type.">qb_rb_open</a>(<span class="stringliteral">&quot;test2&quot;</span>, 2000, <a class="code" href="qbrb_8h.html#ac893c2640e8291e6229a227a861c760c" title="The ringbuffer will be shared between processes.">QB_RB_FLAG_SHARED_PROCESS</a>|<a class="code" href="qbrb_8h.html#a3bf2613790c34f1da4da7e5d28b9f418" title="create a ring buffer (rather than open and existing one)">QB_RB_FLAG_CREATE</a>);
        <span class="keywordflow">for</span> (i = 0; i &lt; 200; i++) {
        try_read_again:
                l = <a class="code" href="qbrb_8h.html#aaeb042cad040e561093604ce5050f85b" title="Read the oldest chunk into data_out.">qb_rb_chunk_read</a>(rb, (<span class="keywordtype">void</span> *)out, 32, 1000);
                <span class="keywordflow">if</span> (l &lt; 0) {
                        <span class="keywordflow">goto</span> try_read_again;
                }
        }
        ...
        <a class="code" href="qbrb_8h.html#a676646fa5f7d2dba585a92b99f91a84c" title="Dereference the ringbuffer and if we are the last user destroy it.">qb_rb_close</a>(rb);
</pre></div>The write process will do the following: </p>
<div class="fragment"><pre class="fragment">        rb = <a class="code" href="qbrb_8h.html#ad7f0ee52204d491ddb6c5adf88e38c31" title="Create the ring buffer with the given type.">qb_rb_open</a>(<span class="stringliteral">&quot;test2&quot;</span>, 2000, <a class="code" href="qbrb_8h.html#ac893c2640e8291e6229a227a861c760c" title="The ringbuffer will be shared between processes.">QB_RB_FLAG_SHARED_PROCESS</a>);
        <span class="keywordflow">for</span> (i = 0; i &lt; 200; i++) {
 try_write_again:
                l = <a class="code" href="qbrb_8h.html#a6be2cb75d70f5befe605501721086121" title="Write a chunk to the ring buffer.">qb_rb_chunk_write</a>(rb, &amp;v, <span class="keyword">sizeof</span>(v));
                <span class="keywordflow">if</span> (l &lt; <span class="keyword">sizeof</span>(v)) {
                        <span class="keywordflow">goto</span> try_write_again;
                }
        }
        ...
        <a class="code" href="qbrb_8h.html#a676646fa5f7d2dba585a92b99f91a84c" title="Dereference the ringbuffer and if we are the last user destroy it.">qb_rb_close</a>(rb);
</pre></div><dl class="author"><dt><b>Author:</b></dt><dd>Angus Salkeld &lt;<a href="mailto:asalkeld@redhat.com">asalkeld@redhat.com</a>&gt; </dd></dl>
 </p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="qbrb_8h.html" title="This implements a ring buffer that works in &quot;chunks&quot; not bytes.">qbrb.h</a> </dd></dl>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on 1 Apr 2016 for libqb by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
